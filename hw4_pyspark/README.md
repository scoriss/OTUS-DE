# HW4 - Сборка витрины на PySpark

**:back: [Назад](/../../)**

## Цель
* В этом задании предлагается собрать статистику по криминогенной обстановке в разных районах Бостона.<br>
В качестве исходных данных используется датасет **[Kaggle - Crimes in Boston](https://www.kaggle.com/AnalyzeBoston/crimes-in-boston)**
* Цель задания - разработать программу построения витрины.
* Программа должна запускаться через **spark-submit**. Пути к данным и к результату должны передаваться в качестве аргументов вызова.

## Подсказки
* Функция `percentile_approx` может посчитать медиану.
* В справочнике кодов есть дубликаты. Нужно выбрать уникальные коды, взяв любое из названий.

## Шаги
1. Загрузить данные.
    * Проверить данные на корректность, наличие дубликатов. Очистить.
2. Собрать витрину (агрегат по районам (поле **district**) со следующими метриками:
    * **crimes_total** - общее количество преступлений в этом районе
    * **crimes_monthly** - медиана числа преступлений в месяц в этом районе
    * **frequent_crime_types** - три самых частых crime_type за всю историю наблюдений в этом районе, объединенных через запятую с одним пробелом “, ” , расположенных в порядке убывания частоты
        * **crime_type** - первая часть NAME из таблицы offense_codes, разбитого по разделителю “-” (например, если NAME “BURGLARY - COMMERICAL - ATTEMPT”, то crime_type “BURGLARY”)
    * **lat** - широта координаты района, рассчитанная как среднее по всем широтам инцидентов
    * **lng** - долгота координаты района, рассчитанная как среднее по всем долготам инцидентов
3. Сохранить витрину в один файл в формате .parquet в папке path/to/output_folder.

## Файлы
* [crimes_in_boston.py](crimes_in_boston.py) - Программа построения витрины на PySpark.

* [crimes_in_boston_analysis.ipynb](crimes_in_boston_analysis.ipynb) - Notebook с предварительным анализом и обработкой данных для построения витрины.

## Запуск программы

```
spark-submit crimes_in_boston.py [path to offense_codes.csv] [path to crime.csv] [path to output_folder]
```

Параметры запуска:
  1. Путь к файлу - ***offense_codes.csv***
  2. Путь к файлу - ***crime.csv***
  3. Путь к папке - ***output_folder*** для parquet-файла